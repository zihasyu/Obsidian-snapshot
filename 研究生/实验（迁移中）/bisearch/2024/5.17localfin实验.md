### 5.17
#### 10个文件做local多层fin单层的测试 
	./LocalDedupSimMain -i /home/public/WYY/linuxTrace -m 7 -r 6 -n 10
实验组 多层local单层fin Compression Ratio = 2300139520 / 276519190 ≈ 8.32
对照组 单层local单层fin Compression Ratio =2300139520 / 283811359 ≈ 8.1
##### 完整数据

实验组
-----------------CHUNK NUM-----------------------
logical chunk num: 270745
unique chunk num: 172102
base chunk num: 60057
delta chunk num: 112045
finesse hit:12278
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 2300139520
unique chunk size: 276519190
dedup chunk size: 0
base chunk size: 252994997
delta chunk size: 23524193
finesse chunk size: 1467462
finesse pre chunk size: 87227004
local chunk size: 21393281
local pre chunk size: 926308639
Compute SF times:72335
Sum Time5: 6 seconds
Fetch Base Chunk Time: 39 seconds
load container times: 609
cache hit times: 201037
Read IO time: 0 seconds
Write IO time: 0 seconds
Update Cache time: 0seconds
Read Cache time: 38seconds

对照组
![[Pasted image 20240518103522.png]]
~
### 5.18


|     | 多层localfin | 单层localfin | 单层finesse |
| --- | ---------- | ---------- | --------- |
| LKT | 15.37      | 14.47      | 11.03     |
| ten | 43.00      | 36.22      | 29.48     |

#### 多层依赖localfin对LKT做
指令
	./LocalDedupSimMain -i /home/public/WYY/LKT_tar_full -m 7 -r 6 -n 84
结果
	2024-05-18 15:28:54 开始
	2024-05-18 16:04:35 结束
	35分钟
	Compression Ratio = 48257771520 / 3139352537 ≈ 15.37
##### 完整数据
-----------------CHUNK NUM-----------------------
logical chunk num: 5600065
unique chunk num: 2950934
base chunk num: 631396
delta chunk num: 2319538
finesse hit:342630
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 48257771520
unique chunk size: 3139352537
dedup chunk size: 0
base chunk size: 2592351751
delta chunk size: 547000786
finesse chunk size: 52853691
finesse pre chunk size: 2835124659
local chunk size: 483191790
local pre chunk size: 18663902833
Compute SF times:974026
Sum Time5: 156 seconds
Fetch Base Chunk Time: 1209 seconds
load container times: 107782
cache hit times: 5411394
Read IO time: 130 seconds
Write IO time: 4 seconds
Update Cache time: 33seconds
Read Cache time: 1063seconds


#### 单层依赖的localfin对LKT做
指令
	./LocalDedupSimMain -i /home/public/WYY/LKT_tar_full -m 7 -r 6 -n 84
	注意是H1目录下的
结果
	2024-05-18 22:03:24开始
	2024-05-18 22:29:18 结束
	 26分钟
	Compression Ratio = 48257771520 / 3335299854 ≈ 14.47
##### 完整数据
-----------------CHUNK NUM-----------------------
logical chunk num: 5600065
unique chunk num: 2950934
base chunk num: 627123
delta chunk num: 2323811
finesse hit:320911
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 48257771520
unique chunk size: 3335299854
dedup chunk size: 0
base chunk size: 2576687434
delta chunk size: 758612420
finesse chunk size: 52253749
finesse pre chunk size: 2652922801
local chunk size: 695464519
local pre chunk size: 18891782506
Compute SF times:948034
Sum Time5: 205 seconds
Fetch Base Chunk Time: 668 seconds
load container times: 83596
cache hit times: 2880431
Read IO time: 102 seconds
Write IO time: 5 seconds
Update Cache time: 26seconds
Read Cache time: 574seconds
#### 单层依赖的纯finesse对LKT做
指令
	./LocalDedupSimMain -i /home/public/WYY/LKT_tar_full -m 1 -r 6 -n 84
结果
	2024-05-18 21:35:50 开始
	2024-05-18 21:54:50 结束
	19分钟
	Compression Ratio = 48257771520 / 4377019751 ≈ 11.03
##### 完整数据
-----------------CHUNK NUM-----------------------
logical chunk num: 5600065
unique chunk num: 2950934
base chunk num: 988972
delta chunk num: 1961962
finesse hit:0
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 48257771520
unique chunk size: 4377019751
dedup chunk size: 0
base chunk size: 4035053439
delta chunk size: 341966312
finesse chunk size: 0
finesse pre chunk size: 0
local chunk size: 0
local pre chunk size: 0
Compute SF times:2950934
Sum Time5: 0 seconds
Fetch Base Chunk Time: 0 seconds
load container times: 97298
cache hit times: 1862940
Read IO time: 119 seconds
Write IO time: 11 seconds
Update Cache time: 30seconds
Read Cache time: 365seconds



#### 多层依赖localfin对ten做
指令
	./LocalDedupSimMain -i /home/public/WYY/ten_full -m 7 -r 6 -n 90
结果
	2024-05-18 22:59:02 开始
	2024-05-18 23:10:36  结束
	20分钟
	Compression Ratio = 20962580480 / 487576185 ≈ 43.00
##### 完整数据
-----------------CHUNK NUM-----------------------
logical chunk num: 2753138
unique chunk num: 1349754
base chunk num: 94968
delta chunk num: 1254786
finesse hit:53524
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 20962580480
unique chunk size: 487576185
dedup chunk size: 0
base chunk size: 313991836
delta chunk size: 173584349
finesse chunk size: 4762450
finesse pre chunk size: 364779892
local chunk size: 167692900
local pre chunk size: 8369682963
Compute SF times:148492
Sum Time5: 48 seconds
Fetch Base Chunk Time: 513 seconds
load container times: 11256
cache hit times: 2496511
Read IO time: 14 seconds
Write IO time: 1 seconds
Update Cache time: 3seconds
Read Cache time: 490seconds


#### 单层依赖的localfin对ten做
指令
	./LocalDedupSimMain -i /home/public/WYY/ten_full -m 7 -r 6 -n 90
	注意是H1目录下的
结果
	2024-05-18 23:30:37开始
	2024-05-18 23:38:27结束
	 8分钟
	Compression Ratio = 20962580480 / 578714659 ≈ 36.22
##### 完整数据
-----------------CHUNK NUM-----------------------
logical chunk num: 2753138
unique chunk num: 1349754
base chunk num: 96282
delta chunk num: 1253472
finesse hit:53026
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 20962580480
unique chunk size: 578714659
dedup chunk size: 0
base chunk size: 317734489
delta chunk size: 260980170
finesse chunk size: 5441616
finesse pre chunk size: 354465509
local chunk size: 254491060
local pre chunk size: 8373095721
Compute SF times:149308
Sum Time5: 67 seconds
Fetch Base Chunk Time: 272 seconds
load container times: 14667
cache hit times: 1316213
Read IO time: 18 seconds
Write IO time: 1 seconds
Update Cache time: 4seconds
Read Cache time: 254seconds
#### 单层依赖的纯finesse对ten做
指令
	./LocalDedupSimMain -i /home/public/WYY/ten_full -m 1 -r 6 -n 90
结果
	2024-05-18 23:19:15 开始
	2024-05-18 23:27:34 结束
	9分钟
	Compression Ratio = 20962580480 / 711090984 ≈ 29.48
##### 完整数据
-----------------CHUNK NUM-----------------------
logical chunk num: 2753138
unique chunk num: 1349754
base chunk num: 222309
delta chunk num: 1127445
finesse hit:0
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 20962580480
unique chunk size: 711090984
dedup chunk size: 0
base chunk size: 593521562
delta chunk size: 117569422
finesse chunk size: 0
finesse pre chunk size: 0
local chunk size: 0
local pre chunk size: 0
Compute SF times:1349754
Sum Time5: 0 seconds
Fetch Base Chunk Time: 0 seconds
load container times: 37433
cache hit times: 1085411
Read IO time: 46 seconds
Write IO time: 2 seconds
Update Cache time: 11seconds
Read Cache time: 214seconds



#### 自然排序
比较大的数据集会遇到版本号顺序并不是按照字典序排序的情况。例如2.2＞2.10，以前有个cmp是当位数不一致时比位数，但感觉会遇到2.10＞5.2的情况。
解决时用到了windows对文件名排序的方法，叫StrCmpLogicalW
在抽象类里加了个static函数NatCompare，实现StrCmpLogicalW，main.cc调用sort时cmp选择NatCompare即可
效果
	/home/public/WYY/ten_full/v2.0.0-rc0.tar
	/home/public/WYY/ten_full/v2.0.0-rc1.tar
	/home/public/WYY/ten_full/v2.0.0-rc2.tar
	/home/public/WYY/ten_full/v2.0.0.tar
	/home/public/WYY/ten_full/v2.0.1.tar
	/home/public/WYY/ten_full/v2.0.2.tar
	/home/public/WYY/ten_full/v2.0.3.tar
	/home/public/WYY/ten_full/v2.0.4.tar
	/home/public/WYY/ten_full/v2.1.0-rc0.tar
	/home/public/WYY/ten_full/v2.1.0-rc1.tar
	/home/public/WYY/ten_full/v2.1.0-rc2.tar
	/home/public/WYY/ten_full/v2.1.0.tar
	/home/public/WYY/ten_full/v2.1.1.tar
	/home/public/WYY/ten_full/v2.1.2.tar
	/home/public/WYY/ten_full/v2.1.3.tar
	/home/public/WYY/ten_full/v2.1.4.tar
	/home/public/WYY/ten_full/v2.2.0-rc0.tar
	/home/public/WYY/ten_full/v2.2.0-rc1.tar
	/home/public/WYY/ten_full/v2.2.0-rc2.tar
	/home/public/WYY/ten_full/v2.2.0-rc3.tar
	/home/public/WYY/ten_full/v2.2.0-rc4.tar
	/home/public/WYY/ten_full/v2.2.0.tar
	/home/public/WYY/ten_full/v2.2.1.tar
	/home/public/WYY/ten_full/v2.2.2.tar
	/home/public/WYY/ten_full/v2.2.3.tar
	/home/public/WYY/ten_full/v2.3.0-rc0.tar
	/home/public/WYY/ten_full/v2.3.0-rc1.tar
	/home/public/WYY/ten_full/v2.3.0-rc2.tar
	/home/public/WYY/ten_full/v2.3.0.tar
	/home/public/WYY/ten_full/v2.3.1.tar
	/home/public/WYY/ten_full/v2.3.2.tar
	/home/public/WYY/ten_full/v2.3.3.tar
	/home/public/WYY/ten_full/v2.3.4.tar
	/home/public/WYY/ten_full/v2.4.0-rc0.tar
	/home/public/WYY/ten_full/v2.4.0-rc1.tar
	/home/public/WYY/ten_full/v2.4.0-rc2.tar
	/home/public/WYY/ten_full/v2.4.0-rc3.tar
	/home/public/WYY/ten_full/v2.4.0-rc4.tar
	/home/public/WYY/ten_full/v2.4.0.tar
	/home/public/WYY/ten_full/v2.4.1.tar
	/home/public/WYY/ten_full/v2.4.2.tar
	/home/public/WYY/ten_full/v2.4.3.tar
	/home/public/WYY/ten_full/v2.4.4.tar
	/home/public/WYY/ten_full/v2.5.0-rc0.tar
	/home/public/WYY/ten_full/v2.5.0-rc1.tar
	/home/public/WYY/ten_full/v2.5.0-rc2.tar
	/home/public/WYY/ten_full/v2.5.0-rc3.tar
	/home/public/WYY/ten_full/v2.5.0.tar
	/home/public/WYY/ten_full/v2.5.1.tar
	/home/public/WYY/ten_full/v2.5.2.tar
	/home/public/WYY/ten_full/v2.5.3.tar
	/home/public/WYY/ten_full/v2.6.0-rc0.tar
	/home/public/WYY/ten_full/v2.6.0-rc1.tar
	/home/public/WYY/ten_full/v2.6.0-rc2.tar
	/home/public/WYY/ten_full/v2.6.0.tar
	/home/public/WYY/ten_full/v2.6.1.tar
	/home/public/WYY/ten_full/v2.6.2.tar
	/home/public/WYY/ten_full/v2.6.3.tar
	/home/public/WYY/ten_full/v2.6.4.tar
	/home/public/WYY/ten_full/v2.6.5.tar
	/home/public/WYY/ten_full/v2.7.0-rc0.tar
	/home/public/WYY/ten_full/v2.7.0-rc1.tar
	/home/public/WYY/ten_full/v2.7.0.tar
	/home/public/WYY/ten_full/v2.7.1.tar
	/home/public/WYY/ten_full/v2.7.2.tar
	/home/public/WYY/ten_full/v2.7.3.tar
	/home/public/WYY/ten_full/v2.7.4.tar
	/home/public/WYY/ten_full/v2.8.0-rc0.tar
	/home/public/WYY/ten_full/v2.8.0-rc1.tar
	/home/public/WYY/ten_full/v2.8.0.tar
	/home/public/WYY/ten_full/v2.8.1.tar
	/home/public/WYY/ten_full/v2.8.2.tar
	/home/public/WYY/ten_full/v2.8.3.tar
	/home/public/WYY/ten_full/v2.8.4.tar
	/home/public/WYY/ten_full/v2.9.0-rc0.tar
	/home/public/WYY/ten_full/v2.9.0-rc1.tar
	/home/public/WYY/ten_full/v2.9.0-rc2.tar
	/home/public/WYY/ten_full/v2.9.0.tar
	/home/public/WYY/ten_full/v2.9.1.tar
	/home/public/WYY/ten_full/v2.9.2.tar
	/home/public/WYY/ten_full/v2.9.3.tar
	/home/public/WYY/ten_full/v2.10.0-rc0.tar
	/home/public/WYY/ten_full/v2.10.0-rc1.tar
	/home/public/WYY/ten_full/v2.10.0-rc2.tar
	/home/public/WYY/ten_full/v2.10.0-rc3.tar
	/home/public/WYY/ten_full/v2.10.0.tar
	/home/public/WYY/ten_full/v2.10.1.tar
	/home/public/WYY/ten_full/v2.11.0-rc0.tar
	/home/public/WYY/ten_full/v2.11.0-rc1.tar
	/home/public/WYY/ten_full/v2.11.0.tar
#### 各种路径留档
单层依赖源码路径H1
	/home/junwu/HotStorage24-LocalDelta
	cp -r /home/junwu/HotStorage24-LocalDelta/* /home/public/WYY/H1
	在H3里解决字典序改为版本号排序的问题
完整数据集路径
	LKT数据集
	/mnt/dataset2/linuxTrace/linuxKernelTrace-tar
	cp -r /mnt/dataset2/linuxTrace/linuxKernelTrace-tar/* /home/public/WYY/LKT_tar_full
	.gz的一些数据集
	/mnt/dataset2/tensorflow
	cp -r /mnt/dataset2/tensorflow/* /home/public/WYY/ten_full
	批量解gz包
	find /home/public/WYY/ten_full -name "*.gz" -exec gunzip {} \;

