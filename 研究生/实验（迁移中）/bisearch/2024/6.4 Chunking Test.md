# Chunking方式调研

https://joshleeb.com/posts/quickcdc-rapidcdc.html
https://joshleeb.com/posts/gear-hashing.html
https://joshleeb.com/posts/fastcdc.html

# 实验设计

## 数据集

Cassandra 前三个backup
## 思路

记录每个chunk的cut point，用来观察在BiSearch中是否定位错位的情况。
## 数据

```SQL
Cut Point 不同时的Compression ratio
zString: Finesse, chunksize Sum: 3619369, Savesize Sum: 228278, Ratio: 15.855093351089462
String: Local, chunksize Sum: 85304880, Savesize Sum: 8588797, Ratio: 9.932110399163003
String: Base, chunksize Sum: 852867, Savesize Sum: 852867, Ratio: 1.0

Cut Point 相同时的Compression ratio
String: Finesse, chunksize Sum: 29219825, Savesize Sum: 772858, Ratio: 37.80749503789829
String: Local, chunksize Sum: 370340244, Savesize Sum: 7487155, Ratio: 49.4634135395888
```

  

## FastCDC 与 Gear 对比

### cassandra少量数据集实验

```SQL
FastCDC  3.576
./BiSearch -i /home/public/WYY/DBset/cassandra -m 7 -r 4 -n 3 

bug num is 107
process last container
Time taken by for loop: 0.317296 minutes
-----------------CHUNK NUM-----------------------
logical chunk num: 135816
unique chunk num: 78162
base chunk num: 58508
delta chunk num: 19654
finesse hit:1589
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 1108418560
unique chunk size: 309945279
dedup chunk size: 0
base chunk size: 306826386
delta chunk size: 3118893
finesse chunk size: 67473
finesse pre chunk size: 3951839
local chunk size: 2653532
local pre chunk size: 136478134
Compute SF times:60097
Sum Time5: 0 seconds
Fetch Base Chunk Time: 4 seconds
load container times: 197
cache hit times: 21773
Read IO time: 0 seconds
Write IO time: 0 seconds
Update Cache time: 0seconds
Read Cache time: 4seconds

Gear-1fff 3.580
bug num is 173
process last container
Time taken by for loop: 0.317523 minutes
-----------------CHUNK NUM-----------------------
logical chunk num: 128313
unique chunk num: 69426
base chunk num: 55006
delta chunk num: 14420
finesse hit:1718
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 1108418560
unique chunk size: 309588649
dedup chunk size: 0
base chunk size: 305617287
delta chunk size: 3971362
finesse chunk size: 244561
finesse pre chunk size: 11048616
local chunk size: 3286575
local pre chunk size: 155986033
Compute SF times:51759
Sum Time5: 1 seconds
Fetch Base Chunk Time: 3 seconds
load container times: 197
cache hit times: 17168
Read IO time: 0 seconds
Write IO time: 0 seconds
Update Cache time: 0seconds
Read Cache time: 3seconds
```

  

  

  

```SQL
FastCDC 4.4548
./BiSearch -i /home/public/WYY/DBset/cassandra -m 7 -r 4 -n 10
bug num is 292
process last container
Time taken by for loop: 1.14782 minutes
-----------------CHUNK NUM-----------------------
logical chunk num: 446388
unique chunk num: 240665
base chunk num: 156063
delta chunk num: 84602
finesse hit:5522
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 3731732480
unique chunk size: 837681811
dedup chunk size: 0
base chunk size: 808545946
delta chunk size: 29135865
finesse chunk size: 621153
finesse pre chunk size: 25007207
local chunk size: 27671649
local pre chunk size: 654773925
Compute SF times:161585
Sum Time5: 6 seconds
Fetch Base Chunk Time: 19 seconds
load container times: 908
cache hit times: 92323
Read IO time: 1 seconds
Write IO time: 0 seconds
Update Cache time: 0seconds
Read Cache time: 18seconds


Gear 1fff 4.4590
./BiSearch -i /home/public/WYY/DBset/cassandra -m 7 -r 4 -n 10
bug num is 507
process last container
Time taken by for loop: 1.72123 minutes
-----------------CHUNK NUM-----------------------
logical chunk num: 416427
unique chunk num: 206330
base chunk num: 149425
delta chunk num: 56905
finesse hit:5980
fake data:0
-----------------CHUNK SIZE-----------------------
logical chunk size: 3731732480
unique chunk size: 836904404
dedup chunk size: 0
base chunk size: 807763293
delta chunk size: 29141111
finesse chunk size: 1177428
finesse pre chunk size: 50306340
local chunk size: 26916412
local pre chunk size: 698758191
Compute SF times:141831
Sum Time5: 7 seconds
Fetch Base Chunk Time: 14 seconds
load container times: 960
cache hit times: 67496
Read IO time: 1 seconds
Write IO time: 1 seconds
Update Cache time: 0seconds
Read Cache time: 13seconds
```

### Linux数据集实验

|   |   |   |   |   |   |
|---|---|---|---|---|---|
|Linux|BiSearch(Odess)|BiSearch(finesse)|Odess|finesse|finesse__Adjacency|
|fastCDC|16.70|14.68|15.23|11.54|12.61|
|Gear|16.04|14.06|14.85|11.34||

./BiSearch -i /home/public/WYY/DBset/LKT_tar_full -m 7 -r 8 -n 84

|   |   |   |
|---|---|---|
|BisearchFinesseGear|14.06|bug num is 1150<br><br>process last container<br><br>Time taken by for loop: 37.7616 minutes<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 5523718<br><br>unique chunk num: 2302824<br><br>base chunk num: 576750<br><br>delta chunk num: 1726074<br><br>finesse hit:403832<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 48257771520<br><br>unique chunk size: 3430286640<br><br>dedup chunk size: 0<br><br>base chunk size: 2692487159<br><br>delta chunk size: 737799481<br><br>finesse chunk size: 106240599<br><br>finesse pre chunk size: 5723488668<br><br>local chunk size: 620580603<br><br>local pre chunk size: 19280118231<br><br>Compute SF times:936937<br><br>Sum Time5: 239 seconds<br><br>Fetch Base Chunk Time: 602 seconds<br><br>load container times: 115900<br><br>cache hit times: 2370658<br><br>Read IO time: 142 seconds<br><br>Write IO time: 6 seconds<br><br>Update Cache time: 36seconds<br><br>Read Cache time: 465seconds|
|BisearchOdessGear|16.04|bug num is 2919<br><br>process last container<br><br>Time taken by for loop: 34.4902 minutes<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 5523718<br><br>unique chunk num: 2302824<br><br>base chunk num: 412852<br><br>delta chunk num: 1889972<br><br>finesse hit:627100<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 48257771520<br><br>unique chunk size: 3008165304<br><br>dedup chunk size: 0<br><br>base chunk size: 1817925454<br><br>delta chunk size: 1190239850<br><br>finesse chunk size: 462569596<br><br>finesse pre chunk size: 8774193135<br><br>local chunk size: 710792821<br><br>local pre chunk size: 18304861637<br><br>Compute SF times:145830<br><br>Sum Time5: 329 seconds<br><br>Fetch Base Chunk Time: 670 seconds<br><br>load container times: 125701<br><br>cache hit times: 2646516<br><br>Read IO time: 154 seconds<br><br>Write IO time: 6 seconds<br><br>Update Cache time: 39seconds<br><br>Read Cache time: 520seconds|
|BiSearch+finesse+fastcdc|14.68|./BiSearch -i /home/public/WYY/DBset/LKT_tar_full -m 7 -r 8 -n 84<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 5269394<br><br>unique chunk num: 2754769<br><br>base chunk num: 608708<br><br>delta chunk num: 2146061<br><br>finesse hit:383865<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 48257771520<br><br>unique chunk size: 3286889933<br><br>dedup chunk size: 0<br><br>base chunk size: 2638645851<br><br>delta chunk size: 648244082<br><br>finesse chunk size: 73573248<br><br>finesse pre chunk size: 3605708220<br><br>local chunk size: 563262596<br><br>local pre chunk size: 18121552210<br><br>---|
|BiSearch+Odess+fastcdc|16.704|-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 5269394<br><br>unique chunk num: 2754769<br><br>base chunk num: 434552<br><br>delta chunk num: 2320217<br><br>finesse hit:635655<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 48257771520<br><br>unique chunk size: 2888959197<br><br>dedup chunk size: 0<br><br>base chunk size: 1833661018<br><br>delta chunk size: 1055298179<br><br>finesse chunk size: 385955704<br><br>finesse pre chunk size: 6340150074<br><br>local chunk size: 651929003<br><br>local pre chunk size: 17203691421|
|finesseGear|11.34|-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 5523718<br><br>unique chunk num: 2302824<br><br>base chunk num: 803031<br><br>delta chunk num: 1499793<br><br>finesse hit:0<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 48257771520<br><br>unique chunk size: 4253821495<br><br>dedup chunk size: 0<br><br>base chunk size: 3860393583<br><br>delta chunk size: 393427912<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>Compute SF times:2255334<br><br>Sum Time5: 0 seconds<br><br>Fetch Base Chunk Time: 0 seconds<br><br>load container times: 95437<br><br>cache hit times: 1402811<br><br>Read IO time: 117 seconds<br><br>Write IO time: 9 seconds<br><br>Update Cache time: 29seconds<br><br>Read Cache time: 270seconds|
|finesseFastCDC|11.55|-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 5269394<br><br>unique chunk num: 2754769<br><br>base chunk num: 883626<br><br>delta chunk num: 1871143<br><br>finesse hit:0<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 48257771520<br><br>unique chunk size: 4178451293<br><br>dedup chunk size: 0<br><br>base chunk size: 3829425213<br><br>delta chunk size: 349026080<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>Compute SF times:2754769<br><br>Sum Time5: 0 seconds<br><br>Fetch Base Chunk Time: 0 seconds<br><br>load container times: 95075<br><br>cache hit times: 1774377<br><br>Read IO time: 117 seconds<br><br>Write IO time: 10 seconds<br><br>Update Cache time: 29seconds<br><br>Read Cache time: 342seconds|
|Odess_Gear|14.85|-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 5523718<br><br>unique chunk num: 2302824<br><br>base chunk num: 507181<br><br>delta chunk num: 1795643<br><br>finesse hit:0<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 48257771520<br><br>unique chunk size: 3248909777<br><br>dedup chunk size: 0<br><br>base chunk size: 2232828314<br><br>delta chunk size: 1016081463<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>Compute SF times:0<br><br>Sum Time5: 0 seconds<br><br>Fetch Base Chunk Time: 0 seconds<br><br>load container times: 94561<br><br>cache hit times: 1697305<br><br>Read IO time: 119 seconds<br><br>Write IO time: 7 seconds<br><br>Update Cache time: 29seconds<br><br>Read Cache time: 335seconds|
|Odess_fastCDC|15.23|-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 5269394<br><br>unique chunk num: 2754769<br><br>base chunk num: 538860<br><br>delta chunk num: 2215909<br><br>finesse hit:0<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 48257771520<br><br>unique chunk size: 3166690306<br><br>dedup chunk size: 0<br><br>base chunk size: 2243555162<br><br>delta chunk size: 923135144<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>Compute SF times:0<br><br>Sum Time5: 0 seconds<br><br>Fetch Base Chunk Time: 0 seconds<br><br>load container times: 94941<br><br>cache hit times: 2118500<br><br>Read IO time: 119 seconds<br><br>Write IO time: 7 seconds<br><br>Update Cache time: 29seconds<br><br>Read Cache time: 418seconds|
|finesse__Adjacency|12.61|-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 5269394<br><br>unique chunk num: 2754769<br><br>base chunk num: 763477<br><br>delta chunk num: 1991292<br><br>finesse hit:0<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 48257771520<br><br>unique chunk size: 3826724367<br><br>dedup chunk size: 0<br><br>base chunk size: 3302888503<br><br>delta chunk size: 523835864<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>Compute SF times:2754769<br><br>Sum Time5: 0 seconds<br><br>Fetch Base Chunk Time: 0 seconds<br><br>load container times: 108887<br><br>cache hit times: 1880338<br><br>Read IO time: 138 seconds<br><br>Write IO time: 6 seconds<br><br>Update Cache time: 34seconds<br><br>Read Cache time: 366seconds|

### cassandra全数据集实验

  

> ./BiSearch -i /home/public/WYY/DBset/cassandra -m 7 -r 8 -n 97

  

|   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|
|docker/cassandra|BiSearch(Odess)|BiSearch(finesse)|Odess|finesse|finesse_adjacency|BiSearch(finesse_adjacency)|
|fastCDC|17.94|17.332|17.418|16.33|17.02|17.716|
|Gear|17.72|17.134|17.306|16.197|||
|多层fastcdc|||17.91||||
|TAR|||||||

|   |   |   |
|---|---|---|
|BiSearch+finesse+fastCDC|Compression=17.332<br><br>bug num is 1191|bug num is 1191<br><br>process last container<br><br>Time taken by for loop: 11.8705 minutes<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 4354882<br><br>unique chunk num: 838088<br><br>base chunk num: 381129<br><br>delta chunk num: 456959<br><br>finesse hit:42243<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 35310059520<br><br>unique chunk size: 2037177084<br><br>dedup chunk size: 0<br><br>base chunk size: 1940712167<br><br>delta chunk size: 96464917<br><br>finesse chunk size: 12744398<br><br>finesse pre chunk size: 281793871<br><br>local chunk size: 80127959<br><br>local pre chunk size: 3321837021<br><br>Compute SF times:423372<br><br>Sum Time5: 25 seconds<br><br>Fetch Base Chunk Time: 138 seconds<br><br>load container times: 11073<br><br>cache hit times: 519542<br><br>Read IO time: 52 seconds<br><br>Write IO time: 2 seconds<br><br>Update Cache time: 5seconds<br><br>Read Cache time: 93seconds|
|0+finesse+fastCDC|Compression=16.33|Time taken by for loop: 5.79777 minutes<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 4186641<br><br>unique chunk num: 808273<br><br>base chunk num: 406738<br><br>delta chunk num: 401535<br><br>finesse hit:0<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 35310059520<br><br>unique chunk size: 2161804234<br><br>dedup chunk size: 0<br><br>base chunk size: 2097655462<br><br>delta chunk size: 64148772<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>Compute SF times:808273<br><br>Sum Time5: 0 seconds<br><br>Fetch Base Chunk Time: 0 seconds<br><br>load container times: 12215<br><br>cache hit times: 384236<br><br>Read IO time: 15 seconds<br><br>Write IO time: 3 seconds<br><br>Update Cache time: 3seconds<br><br>Read Cache time: 76seconds|
|BiSearch+finesse+Gear||bug num is 1950<br><br>process last container<br><br>Time taken by for loop: 15.2826 minutes<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 3957428<br><br>unique chunk num: 640435<br><br>base chunk num: 348676<br><br>delta chunk num: 291759<br><br>finesse hit:39226<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 35310059520<br><br>unique chunk size: 2060809113<br><br>dedup chunk size: 0<br><br>base chunk size: 1948988497<br><br>delta chunk size: 111820616<br><br>finesse chunk size: 12871222<br><br>finesse pre chunk size: 506198182<br><br>local chunk size: 95194340<br><br>local pre chunk size: 3910489017<br><br>Compute SF times:355629<br><br>Sum Time5: 33 seconds<br><br>Fetch Base Chunk Time: 82 seconds<br><br>load container times: 11068<br><br>cache hit times: 354973<br><br>Read IO time: 14 seconds<br><br>Write IO time: 3 seconds<br><br>Update Cache time: 3seconds<br><br>Read Cache time: 70seconds|
|BiSearch+Odess+Gear|17.72|bug num is 4157<br><br>process last container<br><br>Time taken by for loop: 14.4803 minutes<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 3957428<br><br>unique chunk num: 640435<br><br>base chunk num: 328560<br><br>delta chunk num: 311875<br><br>finesse hit:61258<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 35310059520<br><br>unique chunk size: 1992676056<br><br>dedup chunk size: 0<br><br>base chunk size: 1833807894<br><br>delta chunk size: 158868162<br><br>finesse chunk size: 49826917<br><br>finesse pre chunk size: 688788290<br><br>local chunk size: 99184120<br><br>local pre chunk size: 3887560451<br><br>Compute SF times:291271<br><br>Sum Time5: 36 seconds<br><br>Fetch Base Chunk Time: 88 seconds<br><br>load container times: 12520<br><br>cache hit times: 386659<br><br>Read IO time: 16 seconds<br><br>Write IO time: 3 seconds<br><br>Update Cache time: 4seconds<br><br>Read Cache time: 76seconds|
|Odess+Gear|17.306|./BiSearch -i /home/public/WYY/DBset/cassandra -m 12 -r 8 -n 97<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 3957428<br><br>unique chunk num: 640435<br><br>base chunk num: 345602<br><br>delta chunk num: 294833<br><br>finesse hit:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 35310059520<br><br>unique chunk size: 2040224447<br><br>dedup chunk size: 0<br><br>base chunk size: 1919459073<br><br>delta chunk size: 120765374<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>---|
|Finesse+Gear|16.197|./BiSearch -i /home/public/WYY/DBset/cassandra -m 11 -r 8 -n 97<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 3957428<br><br>unique chunk num: 640435<br><br>base chunk num: 377884<br><br>delta chunk num: 262551<br><br>finesse hit:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 35310059520<br><br>unique chunk size: 2179935087<br><br>dedup chunk size: 0<br><br>base chunk size: 2111064490<br><br>delta chunk size: 68870597<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>---|
|Odess+fastcdc|17.418|./BiSearch -i /home/public/WYY/DBset/cassandra -m 8 -r 8 -n 97<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 4186641<br><br>unique chunk num: 808273<br><br>base chunk num: 370191<br><br>delta chunk num: 438082<br><br>finesse hit:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 35310059520<br><br>unique chunk size: 2027202581<br><br>dedup chunk size: 0<br><br>base chunk size: 1906870442<br><br>delta chunk size: 120332139<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>--------------------------------------------------<br><br>---|
|BiSearch+ODESS+FASTCDC|17.94|./BiSearch -i /home/public/WYY/DBset/cassandra -m 9 -r 8 -n 97<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 4186641<br><br>unique chunk num: 808273<br><br>base chunk num: 344360<br><br>delta chunk num: 463913<br><br>finesse hit:69320<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 35310059520<br><br>unique chunk size: 1968173155<br><br>dedup chunk size: 0<br><br>base chunk size: 1817961288<br><br>delta chunk size: 150211867<br><br>finesse chunk size: 45404760<br><br>finesse pre chunk size: 506337978<br><br>local chunk size: 94569574<br><br>local pre chunk size: 3351454794<br><br>---|
|finesse_adjacency|17.02|-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 4186641<br><br>unique chunk num: 808273<br><br>base chunk num: 381310<br><br>delta chunk num: 426963<br><br>finesse hit:0<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 35310059520<br><br>unique chunk size: 2074378830<br><br>dedup chunk size: 0<br><br>base chunk size: 1970056182<br><br>delta chunk size: 104322648<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>Compute SF times:808273<br><br>Sum Time5: 0 seconds<br><br>Fetch Base Chunk Time: 0 seconds<br><br>load container times: 12211<br><br>cache hit times: 406472<br><br>Read IO time: 15 seconds<br><br>Write IO time: 3 seconds<br><br>Update Cache time: 3seconds<br><br>Read Cache time: 76seconds|
|多重odess|17.91|Time taken by for loop: 23.2951 minutes<br><br>-----------------CHUNK NUM-----------------------<br><br>logical chunk num: 4186641<br><br>unique chunk num: 808273<br><br>base chunk num: 365905<br><br>delta chunk num: 442368<br><br>finesse hit:0<br><br>fake data:0<br><br>-----------------CHUNK SIZE-----------------------<br><br>logical chunk size: 35310059520<br><br>unique chunk size: 1971225341<br><br>dedup chunk size: 0<br><br>base chunk size: 1883232333<br><br>delta chunk size: 87993008<br><br>finesse chunk size: 0<br><br>finesse pre chunk size: 0<br><br>local chunk size: 0<br><br>local pre chunk size: 0<br><br>Compute SF times:0<br><br>Sum Time5: 0 seconds<br><br>Fetch Base Chunk Time: 0 seconds<br><br>load container times: 39245<br><br>cache hit times: 5862445<br><br>Read IO time: 48 seconds<br><br>Write IO time: 2 seconds<br><br>Update Cache time: 12seconds<br><br>Read Cache time: 1123seconds|

## 实验总结

在更了解chunking过程，以及做了四种增量方法分别用fastCDC与gear分块的实验后。我们观察到相似块的改动可能比我们之前猜测得多得多。块不是文件，基于内容分块也不是真的内容，而仅仅是基于最近13个字节（8KB的块）来决定断点。

- 原本我们预计的是，base=ABC，new=ADB'C，然后利用历史信息的cutpoint来指导切块，好让D独自做base，然后B‘再把B当作base来增量。但实际上，B'的切点也很容易变了，用历史信息指导很容易在base=ABC，new=AB'C的情况找不到B'。
    
- 考虑到fastCDC的切割方式，也会有这种情况，B'增添了很多内容，新增部分有可以作为断点的内容，于是分裂为B1'B2'，并且B2'因为块大小受到规范化的影响，带走了C的部分内容。此时B1'B2'C'即之后的断点都不再与历史断点相同，无法借助之前的指导。（同时因为边界有所偏移，特征值也会因此错位，乃至B1'B'C'也很难通过finesse或odess找到相似块而作为base，当然长远来看这里作为base可能是更优解？）
    
- 又或者，重复块容易聚集，改动/新增块也容易聚集，会出现base=ABC，new=ADEFG...，会导致浪费很多时间开销也找不到相同的切点。cutpoint在重复块集群中固然稳定，但在改动块的集群中并不可靠。
    
- 最重要的一点，最后这项工作肯定要做成一个系统，那么切块一定要批处理，所以借助历史信息切块的操作不能过于“特制化”，目前看来难以实现，并且效果不好。
    

综上，借助历史信息指导相似块的切割没有良好的效果，但是我们也因此收获了一条以后可能会用到的信息，即**chunking的方式确实对delta compression有影响**。之前的chunking都是针对去重去做去优化，重复块的断点一定会相同。

此外也引发了另一个思考，即**chunk没有太强的metadata可言**。现有特征提取方式得到的SF与块的CutPoint容易受到边界偏移的影响以至于找不到相似块，也因此是弱信息。chunk不像是文件一样有着路径名+文件名此般的决定性相似查找方式，受到chunking方式的影响，特征值也会因重新分块而改变甚多，很难说把所有的优质相似块都找出来。